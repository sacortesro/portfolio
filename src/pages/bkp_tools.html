<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tools Notebook - Bioinformatics Portfolio</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/tools.css">
    <link rel="stylesheet" href="../css/modal.css">
    
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="nav-container">
                <a href="index.html" class="logo">BioPortfolio</a>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="tools.html" class="active">Tools</a></li>
                    <li><a href="projects.html">Projects</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Bioinformatics Tools Notebook</h1>
            <p>A comprehensive collection of tools, techniques, and code examples I use for genomic analysis, data processing, and computational biology research.</p>
        </div>
    </section>

    <div class="container">
        <!-- Search and Filter -->
        <div class="search-filter">
            <input type="text" class="search-input" placeholder="Search tools, techniques, or code examples..." id="searchInput">
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar Navigation -->
            <aside class="sidebar">
                <h3>Tool Categories</h3>
                <ul class="category-nav">
                    <li><a href="#" data-category="sequence-analysis" class="active">Sequence Analysis</a></li>
                    <li><a href="#" data-category="genomics">Genomics & Variants</a></li>
                    <li><a href="#" data-category="structural">Structural Biology</a></li>
                    <li><a href="#" data-category="phylogenetics">Phylogenetics</a></li>
                    <li><a href="#" data-category="machine-learning">Machine Learning</a></li>
                    <li><a href="#" data-category="data-viz">Data Visualization</a></li>
                    <li><a href="#" data-category="databases">Databases & APIs</a></li>
                    <li><a href="#" data-category="workflows">Workflows & Pipelines</a></li>
                </ul>
            </aside>

            <!-- Tools Content -->
            <main class="tools-content">
                <!-- Sequence Analysis -->
                <div class="tool-category active" id="sequence-analysis">
                    <div class="category-header">
                        <h2>Sequence Analysis</h2>
                        <p>Tools for DNA, RNA, and protein sequence manipulation, alignment, and analysis.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">BLAST (Basic Local Alignment Search Tool)</div>
                                    <span class="tool-type">Alignment</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Essential tool for finding regions of similarity between biological sequences. I use BLAST for homology searches, gene identification, and functional annotation.
                            </p>
                            <div class="tool-features">
                                <h4>Key Applications:</h4>
                                <ul class="features-list">
                                    <li>Protein and nucleotide sequence similarity searches</li>
                                    <li>Gene identification and annotation</li>
                                    <li>Phylogenetic analysis preparation</li>
                                    <li>Database searches against NCBI databases</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="bash">
# Basic BLAST search
blastp -query protein.fasta -db mkdbname -out results.txt -outfmt 6 

# Custom BLAST with specific parameters
blastn -query sequences.fasta -db mkdbname -evalue 1e-5 -max_target_seqs 10
                            </div>
                            <div class="tool-links">
                                <a href="https://blast.ncbi.nlm.nih.gov/" class="tool-link">NCBI BLAST</a>
                                <a href="#" class="tool-link scripts-link" data-tool="blast">My BLAST Scripts</a>
                                <!-- <a href="#" class="tool-link">My BLAST Scripts</a> -->
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">BioPython</div>
                                    <span class="tool-type">Python Library</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Comprehensive Python library for biological computation. My go-to tool for sequence manipulation, file parsing, and bioinformatics workflows.
                            </p>
                            <div class="tool-features">
                                <h4>Key Applications:</h4>
                                <ul class="features-list">
                                    <li>FASTA/FASTQ file parsing and manipulation</li>
                                    <li>Sequence translation and reverse complement</li>
                                    <li>Integration with NCBI databases</li>
                                    <li>Phylogenetic tree construction</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
from Bio import SeqIO
from Bio.Seq import Seq

# Parse FASTA file and get basic stats
sequences = []
for record in SeqIO.parse("sequences.fasta", "fasta"):
    sequences.append({
        'id': record.id,
        'length': len(record.seq),
        'gc_content': (record.seq.count('G') + record.seq.count('C')) / len(record.seq)
    })

# Translate DNA to protein
dna_seq = Seq("ATGGCCATTGTAATGGGC")
protein = dna_seq.translate()
                            </div>
                            <div class="tool-links">
                                <a href="https://biopython.org/" class="tool-link">BioPython Docs</a>
                                <a href="#" class="tool-link">My BioPython Scripts</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Multiple Sequence Alignment</div>
                                    <span class="tool-type">Alignment</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Using MUSCLE, ClustalW, and MAFFT for multiple sequence alignments. Essential for comparative genomics and phylogenetic analysis.
                            </p>
                            <div class="tool-features">
                                <h4>Tools Used:</h4>
                                <ul class="features-list">
                                    <li>MUSCLE - Fast and accurate alignment</li>
                                    <li>MAFFT - Large dataset alignment</li>
                                    <li>ClustalW/Omega - Traditional MSA</li>
                                    <li>T-Coffee - Structure-aware alignment</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="bash">
# MUSCLE alignment
muscle -in sequences.fasta -out alignment.fasta

# MAFFT alignment with custom parameters
mafft --auto --thread 4 sequences.fasta > alignment.fasta

# ClustalW alignment
clustalw2 -infile=sequences.fasta -type=protein
                            </div>
                            <div class="tool-links">
                                <a href="#" class="tool-link">Alignment Scripts</a>
                                <a href="#" class="tool-link">Quality Assessment</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Genomics & Variants -->
                <div class="tool-category" id="genomics">
                    <div class="category-header">
                        <h2>Genomics & Variant Analysis</h2>
                        <p>Tools for genome assembly, variant calling, and population genomics analysis.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">GATK (Genome Analysis Toolkit)</div>
                                    <span class="tool-type">Variant Calling</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Industry standard for variant discovery and genotyping. I use GATK for SNP and INDEL calling in both germline and somatic contexts.
                            </p>
                            <div class="tool-features">
                                <h4>Key Workflows:</h4>
                                <ul class="features-list">
                                    <li>Best practices variant calling pipeline</li>
                                    <li>Joint genotyping for population studies</li>
                                    <li>Somatic mutation detection</li>
                                    <li>Variant quality score recalibration</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="bash">
# GATK HaplotypeCaller for variant calling
gatk HaplotypeCaller \
    -R reference.fasta \
    -I sample.bam \
    -O variants.vcf

# Joint genotyping with GenotypeGVCFs
gatk GenotypeGVCFs \
    -R reference.fasta \
    -V cohort.g.vcf \
    -O cohort_variants.vcf
                            </div>
                            <div class="tool-links">
                                <a href="https://gatk.broadinstitute.org/" class="tool-link">GATK Docs</a>
                                <a href="#" class="tool-link">My GATK Pipelines</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">SAMtools & BCFtools</div>
                                    <span class="tool-type">File Processing</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Essential utilities for manipulating SAM/BAM files and variant call format (VCF) files. Core tools in my genomics pipeline.
                            </p>
                            <div class="tool-features">
                                <h4>Common Operations:</h4>
                                <ul class="features-list">
                                    <li>BAM file sorting and indexing</li>
                                    <li>VCF file filtering and annotation</li>
                                    <li>Coverage depth analysis</li>
                                    <li>Format conversion and validation</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="bash">
# Sort and index BAM file
samtools sort input.bam -o sorted.bam
samtools index sorted.bam

# Filter VCF by quality score
bcftools filter -i 'QUAL>30' variants.vcf > filtered.vcf

# Calculate coverage statistics
samtools depth sorted.bam | awk '{sum+=$3} END {print "Average depth:", sum/NR}'
                            </div>
                            <div class="tool-links">
                                <a href="http://samtools.sourceforge.net/" class="tool-link">SAMtools</a>
                                <a href="#" class="tool-link">Processing Scripts</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Structural Biology -->
                <div class="tool-category" id="structural">
                    <div class="category-header">
                        <h2>Structural Biology</h2>
                        <p>Tools for protein structure analysis, modeling, and molecular visualization.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">PyMOL & ChimeraX</div>
                                    <span class="tool-type">Visualization</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Professional molecular visualization software for protein structure analysis and publication-quality figure generation.
                            </p>
                            <div class="tool-features">
                                <h4>Applications:</h4>
                                <ul class="features-list">
                                    <li>3D structure visualization and analysis</li>
                                    <li>Publication-quality figure creation</li>
                                    <li>Molecular dynamics trajectory analysis</li>
                                    <li>Structure comparison and alignment</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
# PyMOL scripting for automated analysis
import pymol
from pymol import cmd

# Load structure and create publication figure
cmd.load("protein.pdb")
cmd.show_as("cartoon")
cmd.color("spectrum")
cmd.set("ray_shadows", 0)
cmd.ray(1200, 900)
cmd.png("protein_figure.png")

# Calculate RMSD between structures
cmd.align("protein1", "protein2")
                            </div>
                            <div class="tool-links">
                                <a href="https://pymol.org/" class="tool-link">PyMOL</a>
                                <a href="#" class="tool-link">Visualization Scripts</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">AlphaFold & ColabFold</div>
                                    <span class="tool-type">Structure Prediction</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                AI-powered protein structure prediction tools. I use these for modeling proteins without known experimental structures.
                            </p>
                            <div class="tool-features">
                                <h4>Capabilities:</h4>
                                <ul class="features-list">
                                    <li>Ab initio protein structure prediction</li>
                                    <li>Confidence score interpretation</li>
                                    <li>Structure validation and analysis</li>
                                    <li>Integration with experimental data</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
# Access AlphaFold database programmatically
import requests

def get_alphafold_structure(uniprot_id):
    url = f"https://alphafold.ebi.ac.uk/files/AF-{uniprot_id}-F1-model_v4.pdb"
    response = requests.get(url)
    if response.status_code == 200:
        with open(f"{uniprot_id}_alphafold.pdb", "w") as f:
            f.write(response.text)
        return True
    return False

# Download AlphaFold structure
get_alphafold_structure("P04637")  # p53 protein
                            </div>
                            <div class="tool-links">
                                <a href="https://alphafold.ebi.ac.uk/" class="tool-link">AlphaFold DB</a>
                                <a href="#" class="tool-link">Prediction Scripts</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Machine Learning -->
                <div class="tool-category" id="machine-learning">
                    <div class="category-header">
                        <h2>Machine Learning in Biology</h2>
                        <p>ML algorithms and frameworks applied to biological problems and data analysis.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Scikit-learn for Genomics</div>
                                    <span class="tool-type">Machine Learning</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Applying classical ML algorithms to genomic data for classification, clustering, and dimensionality reduction tasks.
                            </p>
                            <div class="tool-features">
                                <h4>Applications:</h4>
                                <ul class="features-list">
                                    <li>Gene expression classification</li>
                                    <li>Genomic variant effect prediction</li>
                                    <li>Principal component analysis</li>
                                    <li>Feature selection for biomarkers</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score
import pandas as pd

# Load genomic features
data = pd.read_csv("genomic_features.csv")
X = data.drop(['sample_id', 'phenotype'], axis=1)
y = data['phenotype']

# Train random forest classifier
rf = RandomForestClassifier(n_estimators=100, random_state=42)
scores = cross_val_score(rf, X, y, cv=5)
print(f"CV Accuracy: {scores.mean():.3f} (+/- {scores.std() * 2:.3f})")

# Feature importance analysis
rf.fit(X, y)
feature_importance = pd.DataFrame({
    'feature': X.columns,
    'importance': rf.feature_importances_
}).sort_values('importance', ascending=False)
                            </div>
                            <div class="tool-links">
                                <a href="https://scikit-learn.org/" class="tool-link">Scikit-learn</a>
                                <a href="#" class="tool-link">ML Examples</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">TensorFlow/Keras for Deep Learning</div>
                                    <span class="tool-type">Deep Learning</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Deep learning frameworks for complex biological sequence analysis, including DNA/protein sequence classification and generation.
                            </p>
                            <div class="tool-features">
                                <h4>Projects:</h4>
                                <ul class="features-list">
                                    <li>DNA sequence motif detection</li>
                                    <li>Protein function prediction</li>
                                    <li>Drug-target interaction modeling</li>
                                    <li>Gene expression prediction</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
import tensorflow as tf
from tensorflow.keras import layers, models

# CNN for DNA sequence classification
def create_dna_classifier(sequence_length, num_classes):
    model = models.Sequential([
        layers.Conv1D(32, 8, activation='relu', input_shape=(sequence_length, 4)),
        layers.MaxPooling1D(2),
        layers.Conv1D(64, 8, activation='relu'),
        layers.MaxPooling1D(2),
        layers.Flatten(),
        layers.Dense(64, activation='relu'),
        layers.Dropout(0.5),
        layers.Dense(num_classes, activation='softmax')
    ])
    
    model.compile(optimizer='adam',
                  loss='categorical_crossentropy',
                  metrics=['accuracy'])
    return model

# Create and train model
model = create_dna_classifier(1000, 2)
model.summary()
                            </div>
                            <div class="tool-links">
                                <a href="https://tensorflow.org/" class="tool-link">TensorFlow</a>
                                <a href="#" class="tool-link">DL Projects</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Visualization -->
                <div class="tool-category" id="data-viz">
                    <div class="category-header">
                        <h2>Data Visualization</h2>
                        <p>Tools and libraries for creating compelling visualizations of biological data and analysis results.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Matplotlib & Seaborn</div>
                                    <span class="tool-type">Python Visualization</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Core Python visualization libraries for creating publication-quality plots, heatmaps, and complex multi-panel figures for genomic data.
                            </p>
                            <div class="tool-features">
                                <h4>Plot Types:</h4>
                                <ul class="features-list">
                                    <li>Gene expression heatmaps</li>
                                    <li>Volcano plots for differential expression</li>
                                    <li>Manhattan plots for GWAS results</li>
                                    <li>Principal component analysis plots</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import numpy as np

# Create a gene expression heatmap
def plot_expression_heatmap(expression_data, sample_info):
    plt.figure(figsize=(12, 8))
    
    # Create heatmap with hierarchical clustering
    sns.clustermap(expression_data, 
                   col_colors=sample_info['condition'].map({'control': 'blue', 'treated': 'red'}),
                   cmap='RdBu_r', center=0,
                   figsize=(10, 8))
    
    plt.tight_layout()
    plt.savefig('expression_heatmap.png', dpi=300)

# Volcano plot for differential expression
def volcano_plot(fold_changes, p_values, gene_names):
    plt.figure(figsize=(10, 8))
    
    # Calculate -log10 p-values
    neg_log_p = -np.log10(p_values)
    
    # Color points based on significance and fold change
    colors = ['red' if (abs(fc) > 1 and p < 0.05) else 'gray' 
              for fc, p in zip(fold_changes, p_values)]
    
    plt.scatter(fold_changes, neg_log_p, c=colors, alpha=0.6)
    plt.xlabel('Log2 Fold Change')
    plt.ylabel('-Log10 P-value')
    plt.title('Differential Gene Expression')
    
    # Add significance lines
    plt.axhline(-np.log10(0.05), color='black', linestyle='--', alpha=0.5)
    plt.axvline(1, color='black', linestyle='--', alpha=0.5)
    plt.axvline(-1, color='black', linestyle='--', alpha=0.5)
    
    plt.tight_layout()
    plt.savefig('volcano_plot.png', dpi=300)
                            </div>
                            <div class="tool-links">
                                <a href="https://matplotlib.org/" class="tool-link">Matplotlib</a>
                                <a href="https://seaborn.pydata.org/" class="tool-link">Seaborn</a>
                                <a href="#" class="tool-link">Plot Gallery</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">R/ggplot2 & Bioconductor</div>
                                    <span class="tool-type">R Visualization</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                R ecosystem for statistical analysis and visualization of biological data, with specialized packages for genomics and proteomics.
                            </p>
                            <div class="tool-features">
                                <h4>Key Packages:</h4>
                                <ul class="features-list">
                                    <li>ggplot2 for grammar of graphics</li>
                                    <li>ComplexHeatmap for advanced heatmaps</li>
                                    <li>GenomicRanges for genomic intervals</li>
                                    <li>DESeq2 for differential expression</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="r">
library(ggplot2)
library(DESeq2)
library(ComplexHeatmap)

# DESeq2 analysis and visualization
dds <- DESeqDataSetFromMatrix(countData = counts,
                              colData = sample_info,
                              design = ~ condition)

# Run differential expression analysis
dds <- DESeq(dds)
results <- results(dds, contrast = c("condition", "treated", "control"))

# Create MA plot
plotMA(results, alpha = 0.05, main = "MA Plot")

# PCA plot
vsd <- vst(dds, blind = FALSE)
plotPCA(vsd, intgroup = "condition") +
  theme_minimal() +
  ggtitle("Principal Component Analysis")

# Complex heatmap with annotations
mat <- assay(vsd)[head(order(results$padj), 50), ]
Heatmap(mat, 
        name = "Expression",
        column_title = "Top 50 Differentially Expressed Genes",
        show_row_names = TRUE,
        cluster_rows = TRUE,
        cluster_columns = TRUE)
                            </div>
                            <div class="tool-links">
                                <a href="https://ggplot2.tidyverse.org/" class="tool-link">ggplot2</a>
                                <a href="https://bioconductor.org/" class="tool-link">Bioconductor</a>
                                <a href="#" class="tool-link">R Scripts</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Plotly & Dash</div>
                                    <span class="tool-type">Interactive Viz</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Interactive visualization tools for creating web-based dashboards and exploratory data analysis interfaces for biological datasets.
                            </p>
                            <div class="tool-features">
                                <h4>Applications:</h4>
                                <ul class="features-list">
                                    <li>Interactive genomic browsers</li>
                                    <li>Real-time data exploration dashboards</li>
                                    <li>3D molecular structure viewers</li>
                                    <li>Multi-dimensional data exploration</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
import plotly.graph_objects as go
import plotly.express as px
import dash
from dash import dcc, html, Input, Output

# 3D PCA plot with interactive features
def create_3d_pca_plot(pca_data, sample_info):
    fig = px.scatter_3d(pca_data, 
                        x='PC1', y='PC2', z='PC3',
                        color=sample_info['condition'],
                        hover_data=['sample_id'],
                        title='3D PCA Plot')
    
    fig.update_layout(scene=dict(
        xaxis_title='PC1 (25.3%)',
        yaxis_title='PC2 (18.7%)',
        zaxis_title='PC3 (12.1%)'
    ))
    
    return fig

# Simple Dash app for gene expression exploration
app = dash.Dash(__name__)

app.layout = html.Div([
    html.H1("Gene Expression Explorer"),
    
    dcc.Dropdown(
        id='gene-dropdown',
        options=[{'label': gene, 'value': gene} for gene in gene_list],
        value=gene_list[0]
    ),
    
    dcc.Graph(id='expression-plot')
])

@app.callback(
    Output('expression-plot', 'figure'),
    Input('gene-dropdown', 'value')
)
def update_plot(selected_gene):
    # Create expression plot for selected gene
    fig = px.box(expression_data[selected_gene], 
                 y='expression', 
                 color='condition',
                 title=f'{selected_gene} Expression')
    return fig
                            </div>
                            <div class="tool-links">
                                <a href="https://plotly.com/" class="tool-link">Plotly</a>
                                <a href="https://dash.plotly.com/" class="tool-link">Dash</a>
                                <a href="#" class="tool-link">Interactive Examples</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Databases & APIs -->
                <div class="tool-category" id="databases">
                    <div class="category-header">
                        <h2>Databases & APIs</h2>
                        <p>Programmatic access to biological databases and web services for data retrieval and integration.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">NCBI Entrez & E-utilities</div>
                                    <span class="tool-type">Database API</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Programmatic access to NCBI databases including PubMed, GenBank, and RefSeq for automated data retrieval and literature mining.
                            </p>
                            <div class="tool-features">
                                <h4>Databases Accessed:</h4>
                                <ul class="features-list">
                                    <li>GenBank for sequence data</li>
                                    <li>PubMed for literature searches</li>
                                    <li>RefSeq for reference sequences</li>
                                    <li>SRA for sequencing data</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
from Bio import Entrez
import time

# Set email for NCBI API access
Entrez.email = "your.email@example.com"

def fetch_pubmed_abstracts(query, max_results=100):
    """Fetch PubMed abstracts for a given query"""
    
    # Search PubMed
    search_handle = Entrez.esearch(db="pubmed", 
                                   term=query, 
                                   retmax=max_results)
    search_results = Entrez.read(search_handle)
    search_handle.close()
    
    # Get the list of PubMed IDs
    pmids = search_results["IdList"]
    
    # Fetch abstracts
    abstracts = []
    for pmid in pmids:
        try:
            fetch_handle = Entrez.efetch(db="pubmed", 
                                         id=pmid, 
                                         rettype="abstract", 
                                         retmode="text")
            abstract = fetch_handle.read()
            abstracts.append({
                'pmid': pmid,
                'abstract': abstract
            })
            fetch_handle.close()
            time.sleep(0.1)  # Rate limiting
        except:
            continue
    
    return abstracts

# Example usage
covid_abstracts = fetch_pubmed_abstracts("COVID-19 genomics", max_results=50)

# Fetch gene sequences from GenBank
def get_gene_sequence(gene_name):
    search_handle = Entrez.esearch(db="nucleotide", term=f"{gene_name}[Gene Name]")
    search_results = Entrez.read(search_handle)
    
    if search_results["IdList"]:
        seq_id = search_results["IdList"][0]
        fetch_handle = Entrez.efetch(db="nucleotide", id=seq_id, rettype="fasta", retmode="text")
        sequence = fetch_handle.read()
        return sequence
    
    return None
                            </div>
                            <div class="tool-links">
                                <a href="https://www.ncbi.nlm.nih.gov/books/NBK25501/" class="tool-link">E-utilities Guide</a>
                                <a href="#" class="tool-link">API Scripts</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">UniProt & EBI APIs</div>
                                    <span class="tool-type">Protein Database</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Access to protein sequence and annotation data through UniProt and European Bioinformatics Institute web services.
                            </p>
                            <div class="tool-features">
                                <h4>Data Retrieved:</h4>
                                <ul class="features-list">
                                    <li>Protein sequences and annotations</li>
                                    <li>Functional domain information</li>
                                    <li>Cross-references to other databases</li>
                                    <li>Structural and functional predictions</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
import requests
import json

def get_uniprot_info(uniprot_id):
    """Fetch protein information from UniProt"""
    
    url = f"https://www.uniprot.org/uniprot/{uniprot_id}.json"
    response = requests.get(url)
    
    if response.status_code == 200:
        data = response.json()
        return {
            'protein_name': data.get('proteinDescription', {}).get('recommendedName', {}).get('fullName', {}).get('value'),
            'organism': data.get('organism', {}).get('scientificName'),
            'sequence': data.get('sequence', {}).get('value'),
            'length': data.get('sequence', {}).get('length'),
            'domains': [feature for feature in data.get('features', []) if feature.get('type') == 'domain']
        }
    
    return None

# Batch protein retrieval
def batch_uniprot_search(query, limit=100):
    """Search UniProt with a query and return results"""
    
    url = f"https://www.uniprot.org/uniprot/?query={query}&format=json&limit={limit}"
    response = requests.get(url)
    
    if response.status_code == 200:
        data = response.json()
        return data.get('results', [])
    
    return []

# Example usage
p53_info = get_uniprot_info("P04637")  # Human p53
kinase_proteins = batch_uniprot_search("kinase AND reviewed:yes", limit=50)

# EBI InterPro domain search
def search_interpro_domains(protein_sequence):
    """Search for protein domains using InterPro"""
    
    url = "https://www.ebi.ac.uk/Tools/services/rest/iprscan5/run"
    
    data = {
        'email': 'your.email@example.com',
        'sequence': protein_sequence,
        'goterms': 'true',
        'pathways': 'true'
    }
    
    response = requests.post(url, data=data)
    job_id = response.text
    
    # Poll for results (simplified)
    result_url = f"https://www.ebi.ac.uk/Tools/services/rest/iprscan5/result/{job_id}/json"
    # Implementation would include polling logic here
    
    return job_id
                            </div>
                            <div class="tool-links">
                                <a href="https://www.uniprot.org/help/programmatic_access" class="tool-link">UniProt API</a>
                                <a href="https://www.ebi.ac.uk/Tools/webservices/" class="tool-link">EBI Web Services</a>
                                <a href="#" class="tool-link">Database Scripts</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Phylogenetics -->
                <div class="tool-category" id="phylogenetics">
                    <div class="category-header">
                        <h2>Phylogenetics & Evolution</h2>
                        <p>Tools for evolutionary analysis, phylogenetic tree construction, and comparative genomics.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">IQ-TREE & RAxML</div>
                                    <span class="tool-type">Phylogeny</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                State-of-the-art maximum likelihood phylogenetic inference tools for reconstructing evolutionary relationships from molecular data.
                            </p>
                            <div class="tool-features">
                                <h4>Capabilities:</h4>
                                <ul class="features-list">
                                    <li>Maximum likelihood tree inference</li>
                                    <li>Model selection and testing</li>
                                    <li>Bootstrap support calculation</li>
                                    <li>Large dataset handling</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="bash">
# IQ-TREE analysis with model selection
iqtree -s alignment.fasta -m MFP -bb 1000 -nt AUTO

# RAxML analysis with bootstrap
raxml-ng --all --msa alignment.fasta --model GTR+G --bs-trees 100 --threads 4

# IQ-TREE with partition analysis
iqtree -s concatenated.fasta -p partitions.txt -m MFP+MERGE -bb 1000

# Tree comparison and consensus
iqtree -t tree1.nwk tree2.nwk -rf_adj
                            </div>
                            <div class="tool-links">
                                <a href="http://www.iqtree.org/" class="tool-link">IQ-TREE</a>
                                <a href="https://github.com/amkozlov/raxml-ng" class="tool-link">RAxML-NG</a>
                                <a href="#" class="tool-link">Phylogeny Scripts</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">BioPython Phylogenetics</div>
                                    <span class="tool-type">Python Analysis</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Python tools for phylogenetic analysis, tree manipulation, and evolutionary statistics using BioPython and related packages.
                            </p>
                            <div class="tool-features">
                                <h4>Analysis Types:</h4>
                                <ul class="features-list">
                                    <li>Tree parsing and manipulation</li>
                                    <li>Distance matrix calculations</li>
                                    <li>Evolutionary rate analysis</li>
                                    <li>Tree visualization and annotation</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
from Bio import Phylo, AlignIO
from Bio.Phylo.TreeConstruction import DistanceCalculator, DistanceTreeConstructor
import matplotlib.pyplot as plt

# Load alignment and calculate distance matrix
alignment = AlignIO.read('alignment.fasta', 'fasta')
calculator = DistanceCalculator('identity')
distance_matrix = calculator.get_distance(alignment)

# Construct NJ tree
constructor = DistanceTreeConstructor()
nj_tree = constructor.nj(distance_matrix)

# Visualize tree
fig, ax = plt.subplots(figsize=(12, 8))
Phylo.draw(nj_tree, axes=ax)
plt.tight_layout()
plt.savefig('phylogenetic_tree.png', dpi=300)

# Tree statistics and analysis
def analyze_tree(tree_file):
    tree = Phylo.read(tree_file, 'newick')
    
    # Basic tree statistics
    stats = {
        'total_branch_length': tree.total_branch_length(),
        'num_terminals': len(tree.get_terminals()),
        'num_nonterminals': len(tree.get_nonterminals()),
        'max_distance': max(tree.distance(t) for t in tree.get_terminals())
    }
    
    # Find most distant pair
    terminals = tree.get_terminals()
    max_dist = 0
    most_distant = None
    
    for i, term1 in enumerate(terminals):
        for term2 in terminals[i+1:]:
            dist = tree.distance(term1, term2)
            if dist > max_dist:
                max_dist = dist
                most_distant = (term1.name, term2.name)
    
    stats['most_distant_taxa'] = most_distant
    stats['max_pairwise_distance'] = max_dist
    
    return stats

# Root tree at midpoint
def midpoint_root(tree):
    tree.root_at_midpoint()
    return tree
                            </div>
                            <div class="tool-links">
                                <a href="https://biopython.org/wiki/Phylo" class="tool-link">BioPython Phylo</a>
                                <a href="#" class="tool-link">Tree Analysis Scripts</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Workflows & Pipelines -->
                <div class="tool-category" id="workflows">
                    <div class="category-header">
                        <h2>Workflows & Pipelines</h2>
                        <p>Workflow management systems and pipeline tools for reproducible and scalable bioinformatics analyses.</p>
                    </div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Nextflow</div>
                                    <span class="tool-type">Workflow Manager</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Modern workflow management system for creating scalable and portable bioinformatics pipelines with built-in parallelization and containerization support.
                            </p>
                            <div class="tool-features">
                                <h4>Key Features:</h4>
                                <ul class="features-list">
                                    <li>Dataflow-driven pipeline execution</li>
                                    <li>Docker/Singularity container support</li>
                                    <li>Cloud and HPC cluster deployment</li>
                                    <li>Automatic resumption and caching</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="groovy">
#!/usr/bin/env nextflow

// RNA-seq analysis pipeline example
params.reads = "data/*_{1,2}.fastq.gz"
params.genome = "genome.fa"
params.gtf = "annotations.gtf"

// Create channels
reads_ch = Channel.fromFilePairs(params.reads)
genome_ch = Channel.fromPath(params.genome)
gtf_ch = Channel.fromPath(params.gtf)

// Quality control process
process fastqc {
    publishDir "results/fastqc"
    
    input:
    tuple val(sample_id), path(reads)
    
    output:
    path "*.html"
    
    script:
    """
    fastqc ${reads}
    """
}

// Alignment process
process star_align {
    publishDir "results/alignments"
    
    input:
    tuple val(sample_id), path(reads)
    path genome
    path gtf
    
    output:
    tuple val(sample_id), path("${sample_id}_Aligned.sortedByCoord.out.bam")
    
    script:
    """
    STAR --genomeDir genome_index \\
         --readFilesIn ${reads} \\
         --readFilesCommand zcat \\
         --outSAMtype BAM SortedByCoordinate \\
         --outFileNamePrefix ${sample_id}_
    """
}

// Count features
process feature_counts {
    publishDir "results/counts"
    
    input:
    tuple val(sample_id), path(bam)
    path gtf
    
    output:
    path "${sample_id}_counts.txt"
    
    script:
    """
    featureCounts -T 4 -a ${gtf} -o ${sample_id}_counts.txt ${bam}
    """
}

// Workflow
workflow {
    fastqc(reads_ch)
    
    aligned = star_align(reads_ch, genome_ch, gtf_ch)
    
    feature_counts(aligned, gtf_ch)
}
                            </div>
                            <div class="tool-links">
                                <a href="https://www.nextflow.io/" class="tool-link">Nextflow</a>
                                <a href="#" class="tool-link">My Pipelines</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Snakemake</div>
                                    <span class="tool-type">Workflow Manager</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Python-based workflow management system that uses rules to define analysis steps and automatically determines execution order based on file dependencies.
                            </p>
                            <div class="tool-features">
                                <h4>Advantages:</h4>
                                <ul class="features-list">
                                    <li>Python-based rule definitions</li>
                                    <li>Automatic dependency resolution</li>
                                    <li>Conda environment integration</li>
                                    <li>Cluster and cloud execution</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="python">
# Snakefile for variant calling pipeline
SAMPLES = ["sample1", "sample2", "sample3"]

rule all:
    input:
        "results/variants/all_samples.vcf",
        "results/plots/variant_summary.png"

rule bwa_map:
    input:
        "data/genome.fa",
        "data/{sample}.fastq"
    output:
        "mapped_reads/{sample}.bam"
    conda:
        "envs/alignment.yaml"
    shell:
        "bwa mem {input[0]} {input[1]} | samtools sort -o {output}"

rule samtools_index:
    input:
        "mapped_reads/{sample}.bam"
    output:
        "mapped_reads/{sample}.bam.bai"
    conda:
        "envs/alignment.yaml"
    shell:
        "samtools index {input}"

rule call_variants:
    input:
        fa="data/genome.fa",
        bam=expand("mapped_reads/{sample}.bam", sample=SAMPLES),
        bai=expand("mapped_reads/{sample}.bam.bai", sample=SAMPLES)
    output:
        "results/variants/all_samples.vcf"
    conda:
        "envs/variants.yaml"
    shell:
        "bcftools mpileup -f {input.fa} {input.bam} | "
        "bcftools call -mv -Ov -o {output}"

rule plot_variants:
    input:
        "results/variants/all_samples.vcf"
    output:
        "results/plots/variant_summary.png"
    conda:
        "envs/plotting.yaml"
    script:
        "scripts/plot_variants.py"

# Configuration file: config.yaml
samples:
  - sample1
  - sample2
  - sample3

reference: "data/genome.fa"
                            </div>
                            <div class="tool-links">
                                <a href="https://snakemake.readthedocs.io/" class="tool-link">Snakemake</a>
                                <a href="#" class="tool-link">Workflow Examples</a>
                            </div>
                        </div>

                        <div class="tool-card">
                            <div class="tool-header">
                                <div>
                                    <div class="tool-name">Docker & Singularity</div>
                                    <span class="tool-type">Containerization</span>
                                </div>
                            </div>
                            <p class="tool-description">
                                Containerization technologies for creating reproducible computational environments and sharing bioinformatics tools across different systems.
                            </p>
                            <div class="tool-features">
                                <h4>Use Cases:</h4>
                                <ul class="features-list">
                                    <li>Reproducible analysis environments</li>
                                    <li>Software dependency management</li>
                                    <li>HPC cluster compatibility</li>
                                    <li>Pipeline portability</li>
                                </ul>
                            </div>
                            <div class="code-example" data-language="dockerfile">
# Dockerfile for bioinformatics environment
FROM ubuntu:20.04

# Install system dependencies
RUN apt-get update && apt-get install -y \
    python3 \
    python3-pip \
    r-base \
    wget \
    curl \
    git \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# Install Python packages
RUN pip3 install \
    biopython \
    pandas \
    numpy \
    matplotlib \
    seaborn \
    scikit-learn \
    jupyter

# Install R packages
RUN R -e "install.packages(c('ggplot2', 'dplyr', 'DESeq2'), repos='http://cran.rstudio.com/')"

# Install bioinformatics tools
RUN wget -O /tmp/blast.tar.gz https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.12.0+-x64-linux.tar.gz \
    && tar -xzf /tmp/blast.tar.gz -C /opt/ \
    && ln -s /opt/ncbi-blast-2.12.0+/bin/* /usr/local/bin/

# Install GATK
RUN wget -O /tmp/gatk.zip https://github.com/broadinstitute/gatk/releases/download/4.3.0.0/gatk-4.3.0.0.zip \
    && unzip /tmp/gatk.zip -d /opt/ \
    && ln -s /opt/gatk-4.3.0.0/gatk /usr/local/bin/

# Set working directory
WORKDIR /workspace

# Singularity definition file example
Bootstrap: docker
From: ubuntu:20.04

%post
    apt-get update
    apt-get install -y python3 python3-pip bwa samtools
    pip3 install biopython pandas numpy

%environment
    export PATH="/usr/local/bin:$PATH"

%runscript
    exec "$@"

# Docker compose for multi-container analysis
version: '3.8'
services:
  jupyter:
    build: .
    ports:
      - "8888:8888"
    volumes:
      - ./data:/workspace/data
      - ./results:/workspace/results
    command: jupyter notebook --ip=0.0.0.0 --port=8888 --no-browser --allow-root
  
  database:
    image: postgres:13
    environment:
      POSTGRES_DB: biodata
      POSTGRES_USER: biouser
      POSTGRES_PASSWORD: biopass
    volumes:
      - postgres_data:/var/lib/postgresql/data

                            </div>
                            <div class="tool-links">
                                <a href="https://www.docker.com/" class="tool-link">Docker</a>
                                <a href="https://sylabs.io/singularity/" class="tool-link">Singularity</a>
                                <a href="#" class="tool-link">Container Recipes</a>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal -->
    <div id="scriptsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Tool Scripts</h2>
                <button class="close">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Scripts will be loaded here -->
            </div>
        </div>
    </div>



    <script src="../js/tools.js"></script>
    <script src="../js/modal.js"></script>

</body>
</html>